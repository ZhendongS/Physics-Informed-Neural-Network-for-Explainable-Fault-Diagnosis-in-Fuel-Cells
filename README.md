# Physics-Informed Neural Network for Explainable Fault Diagnosis in Fuel Cells

This repository contains the official implementation of the physics‑informed neural network (PINN) and the downstream diagnostic pipeline developed for the paper:

> **Physics‑informed neural network for explainable fault diagnosis in PEM fuel‑cell stacks**  
> *Authors: \<Sun Zhendong et al.\>*  

The code couples a voltage‑prediction PINN with multi‑physics residuals (voltage, temperature, hydrogen and oxygen stoichiometry), unsupervised/supervised fault diagnosis, and a risk‑function‑based early‑warning index.

---

## Key features

- **Physics‑informed neural network (PINN)** for stack voltage:
  - Trained mainly on *normal* operation data.
  - Embeds electrochemical, thermal, and gas‑stoichiometry constraints.
  - Provides **mean prediction** and **uncertainty**.

- **Multi‑physics residuals and uncertainty**:
  - From the trained PINN and physical sub‑models:
    - Voltage residuals, temperature residuals.
    - Hydrogen and oxygen stoichiometry residuals.
    - Aleatoric and epistemic uncertainty via MC dropout.
  - All exported into a single MATLAB file `F01_output.mat` as `comprehensive_results`.

- **Explainable fault diagnosis**:
  - Supervised **normal vs fault** classification with ROC–AUC for various feature groups.
  - Unsupervised **four‑class** fault diagnosis with GMM + posterior label mapping.
  - 2D scatter plots and t‑SNE visualizations for interpretability.

- **Risk function RF(t) and early‑warning index**:
  - Aggregates multi‑physics residuals into a normalized risk function \( \mathrm{RF}(t) \in [0,1] \).
  - Compares first RF warning time vs voltage threshold crossing under different operating conditions.
  - Quantifies how much earlier the physics‑based RF triggers than raw voltage alarms.

- **Method comparison**:
  - Benchmark six diagnosis methods (GMM, LR, SVM, K‑Means, Agglomerative, Spectral) on four‑class fault diagnosis.
  - Reports accuracy, macro‑precision/recall/F1, and confusion matrices.

---

## Repository structure

Physics-Informed-Neural-Network-for-Explainable-Fault-Diagnosis-in-Fuel-Cells/  
│  
├── 01_train_pinn_multiphysics_model.py  
├── 02_fault_classification_auc.py  
├── 03_unsupervised_gmm_fault_diagnosis.py  
├── 04_risk_function_early_warning_index.py  
├── 05_compare_fault_diagnosis_methods.py  
│  
├── F01_output.mat              # Generated by 01_..., used by all other scripts  
├── requirements                # Python dependencies (see below)  
├── README.md                   # This file  
└── fig_out/                    # Optional: directory for saving figures  
  
The codes are written in Python and use standard scientific libraries.
  
Python ≥ 3.8  
PyTorch ≥ 1.10 (for the PINN)  
NumPy  
SciPy  
scikit‑learn
matplotlib
(optional, for smoothing) pandas
